# Transformer DNS

This repository provides a complete pipeline to train and evaluate a Transformer-based neural network on flow-field time series data generated by Direct Numerical Simulation (DNS). The project is implemented in **PyTorch** and aims to predict future flow-field snapshots given past observations.

## Features

- Data loader and preprocessing utilities for DNS datasets
- Transformer model tailored for spatiotemporal flow data
- Training loop with logging and checkpointing
- Evaluation and visualization scripts

## Directory Structure

```text
├── README.md             - Project overview and usage instructions
├── requirements.txt      - Python dependencies
├── data/                 - Directory for raw and processed DNS data
│   ├── raw/              - Raw simulation outputs
│   └── processed/        - Numpy or HDF5 files ready for training
├── src/                  - Source code
│   ├── dataset.py        - Dataset and preprocessing utilities
│   ├── model.py          - Transformer network definition
│   ├── train.py          - Training script
│   ├── evaluate.py       - Model evaluation script
│   └── utils.py          - Helper functions (logging, checkpoints, etc.)
├── experiments/          - Configurations and results
│   ├── configs/          - YAML config files for experiments
│   └── results/          - Saved models and logs
└── .gitignore            - Files and directories to be ignored by git
```

## Getting Started

1. **Install dependencies**

   ```bash
   pip install -r requirements.txt
   ```

2. **Prepare data**

   Place your raw DNS output files under `data/raw/` and run the preprocessing script:

   ```bash
   python src/dataset.py --prepare --input data/raw --output data/processed
   ```

3. **Train the model**

   ```bash
   python src/train.py --config experiments/configs/default.yaml
   ```

4. **Evaluate**

   ```bash
   python src/evaluate.py --checkpoint experiments/results/best_model.pt
   ```

## Notes

- The provided code offers a starting point and may require adaptation for different DNS datasets.
- See `experiments/configs/default.yaml` for adjustable hyperparameters.

