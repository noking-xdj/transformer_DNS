# Transformer DNS / 变换器直流模拟项目

This repository provides a complete pipeline to train and evaluate a Transformer-based neural network on flow-field time series data generated by Direct Numerical Simulation (DNS).

本仓库提供基于 **PyTorch** 的完整流程，用于在直接数值模拟（DNS）生成的流场时间序列上训练与评估 Transformer 神经网络，目标是根据历史观测预测未来的流场快照。

## Features / 功能特点

- Data loader and preprocessing utilities for DNS datasets
  为 DNS 数据集提供数据加载与预处理工具
- Transformer model tailored for spatiotemporal flow data
  为时空流场数据定制的 Transformer 模型
- Training loop with logging and checkpointing
  含日志与检查点保存的训练循环
- Evaluation and visualization scripts
  提供模型评估和可视化脚本

## Directory Structure / 目录结构

```text
├── README.md             - Project overview and usage instructions / 项目说明
├── requirements.txt      - Python dependencies / Python 依赖
├── data/                 - Directory for raw and processed DNS data / 原始与处理后数据目录
│   ├── raw/              - Raw simulation outputs / 原始模拟结果
│   └── processed/        - Numpy or HDF5 files ready for training / 可直接用于训练的文件
├── src/                  - Source code / 源代码
│   ├── dataset.py        - Dataset and preprocessing utilities / 数据集与预处理
│   ├── model.py          - Transformer network definition / Transformer 模型定义
│   ├── train.py          - Training script / 训练脚本
│   ├── evaluate.py       - Model evaluation script / 评估脚本
│   └── utils.py          - Helper functions (logging, checkpoints, etc.) / 辅助函数
├── experiments/          - Configurations and results / 实验配置与结果
│   ├── configs/          - YAML config files for experiments / YAML 配置文件
│   └── results/          - Saved models and logs / 模型与日志保存目录
└── .gitignore            - Files and directories to be ignored by git / Git 忽略规则
```

## Getting Started / 快速开始

1. **Install dependencies / 安装依赖**

   ```bash
   pip install -r requirements.txt
   ```

2. **Prepare data / 准备数据**

   Place your raw DNS output files under `data/raw/` and run the preprocessing script:

   ```bash
   python src/dataset.py --prepare --input data/raw --output data/processed
   ```

3. **Train the model / 训练模型**

   ```bash
   python src/train.py --config experiments/configs/default.yaml
   ```

4. **Evaluate / 模型评估**

   ```bash
   python src/evaluate.py --checkpoint experiments/results/best_model.pt
   ```

## Notes / 备注

- The provided code offers a starting point and may require adaptation for different DNS datasets.
  本代码为你提供了开始，可能需要根据不同数据集进行调整
- See `experiments/configs/default.yaml` for adjustable hyperparameters.
  参见 `experiments/configs/default.yaml` 以修改超参

=======
